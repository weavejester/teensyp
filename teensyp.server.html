<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>teensyp.server documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Teensyp</span> <span class="project-version">0.1.1</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>teensyp</span></div></div></li><li class="depth-2 branch"><a href="teensyp.buffer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>buffer</span></div></a></li><li class="depth-2 current"><a href="teensyp.server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>server</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="teensyp.server.html#var-CLOSE"><div class="inner"><span>CLOSE</span></div></a></li><li class="depth-1"><a href="teensyp.server.html#var-PAUSE-READS"><div class="inner"><span>PAUSE-READS</span></div></a></li><li class="depth-1"><a href="teensyp.server.html#var-RESUME-READS"><div class="inner"><span>RESUME-READS</span></div></a></li><li class="depth-1"><a href="teensyp.server.html#var-start-server"><div class="inner"><span>start-server</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">teensyp.server</h1><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-CLOSE"><h3>CLOSE</h3><div class="usage"></div><div class="doc"><pre class="plaintext">A unique identifier that can be passed to the write function of a handler
in order to close the connection.</pre></div></div><div class="public anchor" id="var-PAUSE-READS"><h3>PAUSE-READS</h3><div class="usage"></div><div class="doc"><pre class="plaintext">A unique identifier that can be passed to the write function of a handler
in order to pause reads. See: RESUME-READS.</pre></div></div><div class="public anchor" id="var-RESUME-READS"><h3>RESUME-READS</h3><div class="usage"></div><div class="doc"><pre class="plaintext">A unique identifier that can be passed to the write function of a handler
in order to pause reads. See: RESUME-READS.</pre></div></div><div class="public anchor" id="var-start-server"><h3>start-server</h3><div class="usage"><code>(start-server {:keys [port executor], :as opts})</code></div><div class="doc"><pre class="plaintext">Start a TCP server with the supplied map of options:

- `:port` - the port number to listen on (mandatory)
- `:handler` - a handler function (mandatory, see below)
- `:executor` - a custom ExecutorService to supply worker threads
- `:buffer-size` - the buffer size in bytes (default 8K)

The handler function must have three arities:

    (fn handler
      ([write] initial-state)           ;; on socket accept
      ([state buffer write] new-state)  ;; on socket read data
      ([state exception]))              ;; on socket close

The `buffer` is a java.nio.ByteBuffer instance, and `write` is a function
that takes a buffer as an argument and will queue it to send to the client.
To close the channel, pass `teensyp.server/CLOSE` to the write function.

The `state` is a custom data structure that is returned when the accept or
read arities are triggered. A different state is associated with each
connection.

When closing, the `exception` may contain the exception that terminated the
channel, or `nil` if the channel were terminated gracefully.

The handler function is guaranteed to execute in serial per channel. That is,
the accept will always be first, the close will always be last, and reads
will always be sequential.</pre></div></div></div></body></html>